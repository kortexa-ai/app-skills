---
name: osx-app
description: Create a macOS desktop app using Capacitor + Electron + React. Zero to running app in 3 commands.
---

# macOS App - Capacitor + Electron + React

Create a macOS desktop application using Capacitor with Electron and React.

## Quick Reference

```bash
# Create project
mkdir ~/src/myapp.desktop && cd ~/src/myapp.desktop

# Install deps
npm install

# Setup Electron platform
npm run setup

# Run the app
npm run electron:dev
```

## Phase 1: Project Info

### Infer or Ask

1. **App name**: Infer from current folder (e.g., `myapp.desktop` → "My App"), confirm with user
2. **Slug**: Derive from folder name (e.g., `myapp.desktop` → `myapp`)
3. **Bundle ID**: Suggest `com.yourcompany.{slug}`, confirm with user

### Naming Convention

- Folder ends with `.desktop` (e.g., `myapp.desktop`)
- This distinguishes desktop apps from web apps and iOS apps

## Phase 2: Project Structure

```
~/src/myapp.desktop/
├── src/
│   ├── App.tsx
│   ├── main.tsx
│   └── index.css
├── index.html
├── capacitor.config.ts
├── vite.config.ts
├── tsconfig.json
├── package.json
├── README.md
└── .gitignore
```

After running `npm run setup`, an `electron/` folder is generated by Capacitor.

## Phase 3: Configuration Files

### package.json

```json
{
  "name": "myapp-desktop",
  "version": "1.0.0",
  "description": "My App - Capacitor + Electron + React",
  "main": "index.js",
  "scripts": {
    "start": "vite",
    "build": "vite build",
    "preview": "vite preview",
    "setup": "npm run build && npx cap add @capacitor-community/electron",
    "cap:sync": "npx cap sync",
    "electron:dev": "npm run build && npx cap sync @capacitor-community/electron && npx cap open @capacitor-community/electron",
    "electron:build": "npm run build && npx cap sync @capacitor-community/electron"
  },
  "dependencies": {
    "@capacitor/core": "^8.0.0",
    "react": "^19.0.0",
    "react-dom": "^19.0.0"
  },
  "devDependencies": {
    "@capacitor-community/electron": "^5.0.0",
    "@capacitor/cli": "^8.0.0",
    "@vitejs/plugin-react-swc": "^4.0.0",
    "typescript": "^5.9.0",
    "vite": "^7.0.0"
  }
}
```

> **Note:** Always use the latest stable versions when creating a new project. Run `npm view <package> version` to check current latest. The versions above are minimums that have been tested together.

> **Known Warning:** When using `@vitejs/plugin-react-swc`, you may see: "Unable to find node_modules/@vitejs/plugin-react-swc". This is a [known issue](https://github.com/capacitor-community/electron/issues/262) with `@capacitor-community/electron`'s plugin detection. The warning is harmless - the SWC plugin is only used during Vite's build step, not by Electron at runtime. The sync will complete successfully and your app will work normally. You can safely ignore this warning.

### Styling with Tailwind CSS

For styling, **use Tailwind CSS v3** (not v4). Tailwind v4 uses CSS-native `@layer` and `@import` syntax that can have compatibility issues with Electron's older Chromium version, resulting in missing spacing/padding.

**Install Tailwind v3:**
```bash
npm install -D tailwindcss@3 postcss autoprefixer
npx tailwindcss init -p
```

**tailwind.config.js:**
```javascript
/** @type {import('tailwindcss').Config} */
export default {
  content: [
    "./index.html",
    "./src/**/*.{js,ts,jsx,tsx}",
  ],
  theme: {
    extend: {},
  },
  plugins: [],
}
```

**src/index.css:**
```css
@tailwind base;
@tailwind components;
@tailwind utilities;

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  background: #0a0a0f;
  color: #e5e5e5;
}
```

**vite.config.ts** (no Tailwind plugin needed for v3):
```typescript
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react-swc';

export default defineConfig({
  plugins: [react()],
  build: {
    outDir: 'dist'
  }
});
```

### capacitor.config.ts

```typescript
import type { CapacitorConfig } from '@capacitor/cli';

const config: CapacitorConfig = {
  appId: 'com.yourcompany.myapp',  // Change to your bundle ID
  appName: 'My App',               // Change to your app name
  webDir: 'dist',
  server: {
    androidScheme: 'https'
  }
};

export default config;
```

### vite.config.ts

```typescript
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react-swc';

export default defineConfig({
  plugins: [react()],
  build: {
    outDir: 'dist'
  }
});
```

### tsconfig.json

```json
{
  "compilerOptions": {
    "target": "ES2020",
    "useDefineForClassFields": true,
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "module": "ESNext",
    "skipLibCheck": true,
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "resolveJsonModule": true,
    "isolatedModules": true,
    "noEmit": true,
    "jsx": "react-jsx",
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "noFallthroughCasesInSwitch": true
  },
  "include": ["src"]
}
```

### .gitignore

```
node_modules
dist
electron
.DS_Store
*.log
```

### index.html

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My App</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
```

### README.md

```markdown
# My App

Desktop app using Capacitor + Electron + React.

## Quick Start

\`\`\`bash
npm install
npm run setup
npm run electron:dev
\`\`\`

## Scripts

- `npm run setup` - Initial setup (build + add Electron platform)
- `npm run electron:dev` - Build and run the Electron app
- `npm start` - Run Vite dev server (web only)
\`\`\`
```

## Phase 4: Source Files

### src/main.tsx

```typescript
import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './App';
import './index.css';

ReactDOM.createRoot(document.getElementById('root')!).render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);
```

### src/App.tsx

```typescript
import { useState } from 'react';

function App() {
  const [count, setCount] = useState(0);

  return (
    <div className="app">
      <h1>Hello World!</h1>
      <p>Capacitor + Electron + React</p>
      <div className="card">
        <button onClick={() => setCount(c => c + 1)}>
          Count: {count}
        </button>
      </div>
      <p className="hint">Running on macOS via Electron</p>
    </div>
  );
}

export default App;
```

### src/index.css

```css
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  color: #fff;
  min-height: 100vh;
}

.app {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-height: 100vh;
  padding: 2rem;
  text-align: center;
}

h1 {
  font-size: 3rem;
  margin-bottom: 0.5rem;
}

p {
  color: #888;
  margin-bottom: 1rem;
}

.card {
  padding: 2rem;
}

button {
  background: #646cff;
  color: white;
  border: none;
  padding: 1rem 2rem;
  font-size: 1.2rem;
  border-radius: 8px;
  cursor: pointer;
  transition: background 0.2s;
}

button:hover {
  background: #535bf2;
}

.hint {
  margin-top: 2rem;
  font-size: 0.9rem;
  color: #666;
}
```

## Phase 5: Development

### Install and Run

```bash
cd ~/src/myapp.desktop
npm install
npm run setup
npm run electron:dev
```

### Verify

- [ ] App window opens on macOS
- [ ] React renders correctly
- [ ] State (counter) works
- [ ] No console errors

## Phase 6: Key Scripts

| Script | Description |
|--------|-------------|
| `npm run setup` | One-time setup: builds web app and adds Electron platform |
| `npm run electron:dev` | Build, sync, and launch Electron app |
| `npm run electron:build` | Build and sync without launching |
| `npm run cap:sync` | Sync web code to Electron without building |
| `npm start` | Run Vite dev server (web preview only) |

## Phase 7: App Icon Generation

Use the `/app-logo` skill or generate directly with Gemini:

### Prerequisites

Set up your Gemini API key (get one free at [Google AI Studio](https://aistudio.google.com/apikey)):

```bash
export GEMINI_API_KEY="your-api-key-here"
```

### Generate Icon

```bash
curl -s "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash-exp:generateContent?key=$GEMINI_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "contents": [{
      "parts": [{
        "text": "Generate an image: Minimalist app icon for [YOUR APP], 3D geometric shape, dark navy background with purple cyan gradient glow, professional macOS app icon style, rounded corners"
      }]
    }],
    "generationConfig": {
      "responseModalities": ["image", "text"]
    }
  }' | python3 -c "
import json, base64, sys
data = json.load(sys.stdin)
img_data = data['candidates'][0]['content']['parts'][0]['inlineData']['data']
with open('appIcon.png', 'wb') as f:
    f.write(base64.b64decode(img_data))
print('Icon saved to appIcon.png')
"

# Resize for Electron
magick appIcon.png -resize 512x512 electron/assets/appIcon.png
```

## Phase 8: Customizing Electron

After running `npm run setup`, Capacitor creates an `electron/` folder. You can customize:

- `electron/src/index.ts` - Main process, window config, menus
- `electron/src/setup.ts` - Tray icon, window management
- `electron/src/preload.ts` - IPC communication with renderer
- `electron/capacitor.config.json` - Electron-specific Capacitor config

### IMPORTANT: Preserve Customizations

The `electron/` folder is generated by Capacitor but contains your custom code. **Remove `electron/` from `.gitignore`** to preserve customizations:

```
node_modules
dist
.DS_Store
*.log
```

### Common Customizations

**Custom Dock Icon (macOS)** - Edit `electron/src/setup.ts` in the `init()` method:

```typescript
const icon = nativeImage.createFromPath(
  join(app.getAppPath(), 'assets', process.platform === 'win32' ? 'appIcon.ico' : 'appIcon.png')
);

// Set dock icon on macOS (works in dev mode too)
if (process.platform === 'darwin' && !icon.isEmpty()) {
  app.dock.setIcon(icon);
}
```

Add your icon to `electron/assets/appIcon.png` (512x512px for macOS). The icon will appear in:
- macOS Dock (including dev mode)
- App switcher (Cmd+Tab)
- Window title bar

**Window size** - Edit `electron/src/setup.ts`:
```typescript
mainWindow = new BrowserWindow({
  width: 1200,
  height: 800,
  // ...
});
```

**System Tray Icon** - Requires changes to multiple files:

1. **Enable in `capacitor.config.ts`:**
```typescript
const config: CapacitorConfig = {
  // ... other config
  electron: {
    trayIconAndMenuEnabled: true
  }
};
```

2. **Add tray icon to `electron/assets/`** (e.g., `trayIcon.png`, 44x44px for retina)

3. **Customize tray menu in `electron/src/index.ts`:**
```typescript
const trayMenuTemplate: (MenuItemConstructorOptions | MenuItem)[] = [
  {
    label: 'Show App',
    click: () => {
      myCapacitorApp.getMainWindow().show();
      myCapacitorApp.getMainWindow().focus();
      if (process.platform === 'darwin' && app.dock.isVisible() === false) {
        app.dock.show();
      }
    }
  },
  {
    label: 'Hide App',
    click: () => {
      myCapacitorApp.getMainWindow().hide();
      if (process.platform === 'darwin') {
        app.dock.hide();  // Remove from Cmd+Tab
      }
    }
  },
  { type: 'separator' },
  { label: 'Quit App', role: 'quit' }
];
```

**Custom App Menu** - Modify `appMenuBarMenuTemplate` in `electron/src/index.ts`:
```typescript
const appMenuBarMenuTemplate: (MenuItemConstructorOptions | MenuItem)[] = [
  { role: process.platform === 'darwin' ? 'appMenu' : 'fileMenu' },
  {
    label: 'Tools',
    submenu: [
      {
        label: 'Reset Count',
        accelerator: 'CmdOrCtrl+R',
        click: () => {
          // Send IPC message to renderer
          mainWindowRef.webContents.send('reset-count');
        }
      }
    ]
  },
  { role: 'viewMenu' },
];
```

**IPC Communication (Menu → React)**:

1. **Expose API in `electron/src/preload.ts`:**
```typescript
import { contextBridge, ipcRenderer } from 'electron';

contextBridge.exposeInMainWorld('electronAPI', {
  onResetCount: (callback: () => void) => {
    ipcRenderer.on('reset-count', callback);
  },
});
```

2. **Listen in React (`src/App.tsx`):**
```typescript
declare global {
  interface Window {
    electronAPI?: {
      onResetCount: (callback: () => void) => void;
    };
  }
}

useEffect(() => {
  if (window.electronAPI) {
    window.electronAPI.onResetCount(() => {
      setCount(0);
    });
  }
}, []);
```

**Native features** - Use Capacitor plugins or Electron APIs directly

## Phase 9: Building for Distribution

```bash
# Build the web app
npm run build

# Sync to Electron
npx cap sync @capacitor-community/electron

# Build distributable (in electron folder)
cd electron
npm run build
```

The built app will be in `electron/dist/`.

## Troubleshooting

### "Could not find installation of TypeScript"

Make sure `typescript` is in devDependencies:
```bash
npm install -D typescript
```

### Electron window is blank

1. Check that `npm run build` completed successfully
2. Verify `dist/` folder has `index.html`
3. Run `npx cap sync @capacitor-community/electron`

### Changes not showing

After code changes:
```bash
npm run electron:dev
```

This rebuilds and syncs before launching.

### No existing Capacitor plugins for desktop features

There are no Capacitor plugins for system tray, dock management, or custom app menus. These require direct Electron API access via the `electron/` folder customizations described above.

## Checklist

### Initial Setup
- [ ] Project folder created with `.desktop` suffix
- [ ] All config files in place
- [ ] `npm install` completed
- [ ] `npm run setup` completed (Electron platform added)
- [ ] App launches with `npm run electron:dev`

### Customization
- [ ] App name updated in `capacitor.config.ts` and `index.html`
- [ ] Bundle ID set in `capacitor.config.ts`
- [ ] App.tsx customized with actual content
- [ ] Styling updated in index.css
- [ ] App icon generated and placed in `electron/assets/`

## See Also

- `/app-logo` - Generate app icons with AI
- `/ios-app` - Create iOS apps with React Native
